# Build the application
build: build-bin build-docker

# Build multiarch binaries
build-bin:
  #!/bin/bash
  for os in {{OS}}
  do
    for arch in {{ARCH}}
    do
      echo "Building zdravko for $os $arch..."
      CGO_ENABLED=0 GOOS=$os GOARCH=$arch go build -o bin/zdravko-$os-$arch cmd/zdravko/main.go
    done
  done

# Build docker image
build-docker: build-bin
  #!/bin/bash
  docker buildx build \
    -f build/Dockerfile \
    -t {{DOCKER_IMAGE}} \
    .
